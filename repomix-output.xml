This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.gitignore
actions/auth.ts
actions/createCourse.schema.ts
actions/createCourse.ts
actions/logout.ts
actions/toggleProgress.ts
app/(course)/courses/[courseId]/[chapterId]/page.tsx
app/(course)/courses/[courseId]/layout.tsx
app/(course)/courses/[courseId]/page.tsx
app/(course)/courses/[courseId]/SidebarNav.tsx
app/(course)/courses/courseContext.tsx
app/(course)/courses/CourseProvider.tsx
app/(dashboard)/create-course/page.tsx
app/(dashboard)/create-course/SubmitButton.tsx
app/(dashboard)/dashboard/page.tsx
app/(dashboard)/layout.tsx
app/(marketing)/login/page.tsx
app/(marketing)/signup/page.tsx
app/favicon.ico
app/globals.css
app/layout.tsx
app/page.tsx
components.json
components/ui/button.tsx
components/ui/card.tsx
components/ui/input.tsx
components/ui/navbar.tsx
components/ui/progress.tsx
components/ui/separator.tsx
eslint.config.mjs
lib/ai/parser.ts
lib/ai/prompts.ts
lib/ai/schema.ts
lib/auth.ts
lib/db.ts
lib/errors/domain.ts
lib/password.ts
lib/repositories/course.repo.ts
lib/session.ts
lib/utils.ts
next.config.ts
package.json
postcss.config.mjs
prisma/migrations/20260115194420_init/migration.sql
prisma/migrations/20260205091441_add_progress_and_status/migration.sql
prisma/migrations/migration_lock.toml
prisma/schema.prisma
public/file.svg
public/globe.svg
public/next.svg
public/vercel.svg
public/window.svg
README.md
services/ai.service.ts
services/auth.service.ts
services/course.service.ts
services/progress.service.ts
services/youtube.service.ts
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="actions/auth.ts">
'use server'

import { SESSION_KEY } from "@/lib/session";
import { authService } from "@/services/auth.service";
import { cookies } from "next/headers";
import { redirect } from "next/navigation";

export type AuthState = {
  error: string | null;
};

export async function Signup(prevState: AuthState, formData: FormData){
  const email = formData.get("email")?.toString();
  const password = formData.get("password")?.toString();

  if(!email || !password){
    return { error: "Missing Fields!"}
  }

  try{
    const user = await authService.signup(email, password);

    const cookie = await cookies()
    cookie.set(SESSION_KEY, user.id, {
    httpOnly: true,
    path: "/"
  })
    
  }catch(err: any){
    return { error: err.message }
  }
  redirect("/dashboard")
}

export async function login(prevState: AuthState, formData: FormData){
  const email = formData.get("email")?.toString();
  const password = formData.get("password")?.toString();

  if(!email || !password){
    return { error: "Missing Fields!"}
  }

  try{
    const user = await authService.login(email, password);
    
    const cookie = await cookies()
    cookie.set(SESSION_KEY, user.id, {
    httpOnly: true,
    path: "/"
  })
    
  }catch(err: any){
    return { error: err.message }
  }
  redirect("/dashboard")
}
</file>

<file path="actions/createCourse.schema.ts">
import z from "zod";

export const createCourseSchema = z.object({
  topic: z.string().min(3, "Topic must be atleast 3 characters"),
  level: z.enum(["beginner", "intermediate", "advanced"]),
  chapters: z.enum(["5", "8", "12"]),
  duration: z.enum(["30", "60", "90"]),
})

export type CreateCourseInput = z.infer<typeof createCourseSchema>;
</file>

<file path="actions/logout.ts">
'use server'
import { SESSION_KEY } from "@/lib/session";
import { cookies } from "next/headers";
import { redirect } from "next/navigation";

export async function logout(){
  const cookie = await cookies();
  cookie.delete(SESSION_KEY);
  redirect("/login")
}
</file>

<file path="actions/toggleProgress.ts">
"use server"

import { getCurrentUser } from "@/lib/auth";
import { progressService } from "@/services/progress.service";

export async function toggleProgress(courseId: string, chapter: number){
  const user = await getCurrentUser();

  if(!user) throw new Error("UnAuthorized");

  await progressService.toggleChapter(user.id, courseId, chapter)
}
</file>

<file path="app/(course)/courses/[courseId]/SidebarNav.tsx">
"use client";

import Link from "next/link";
import { usePathname } from "next/navigation";
import { Check } from "lucide-react";

interface SidebarNavProps {
  courseId: string;
  chapters: any[];
  completedSet: Set<number>;
}

export default function SidebarNav({ courseId, chapters, completedSet }: SidebarNavProps) {
  const pathname = usePathname();

  return (
    <ul className="space-y-2">
      {chapters.map((chapter, index) => {
        const isDone = completedSet.has(index);
        
        // This is the bulletproof check: does the current URL end with this index?
        const href = `/courses/${courseId}/${index}`;
        const isActive = pathname === href;

        return (
          <li key={index}>
            <Link
              href={href}
              className={`group flex items-center justify-between px-4 py-3 rounded-xl transition-all duration-200 border ${
                isActive
                  ? "bg-primary text-black border-primary font-bold shadow-lg shadow-primary/20"
                  : "text-muted-foreground hover:bg-white/5 border-transparent hover:text-white"
              }`}
            >
              <div className="flex flex-col min-w-0">
                <span className="text-sm truncate">
                  {index + 1}. {chapter.title}
                </span>
                <span className={`text-[10px] font-medium ${isActive ? "text-black/70" : "text-muted-foreground"}`}>
                  {chapter.durationMinutes} mins
                </span>
              </div>
              
              {isDone && (
                <Check className={`w-4 h-4 shrink-0 ml-2 ${isActive ? "text-black" : "text-primary"}`} />
              )}
            </Link>
          </li>
        );
      })}
    </ul>
  );
}
</file>

<file path="app/(course)/courses/courseContext.tsx">
'use client'
import { createContext } from "react";
import { Course } from "@/services/course.service";

export const CourseContext = createContext<Course | null>(null);
</file>

<file path="app/(course)/courses/CourseProvider.tsx">
"use client";

import { CourseContext } from "./courseContext";
import { Course } from "@/services/course.service";

export default function CourseProvider({
  course,
  children,
}: {
  course: Course;
  children: React.ReactNode;
}) {
  return (
    <CourseContext.Provider value={course}>
      {children}
    </CourseContext.Provider>
  );
}
</file>

<file path="app/(dashboard)/layout.tsx">
export const dynamic = "force-dynamic";

import { getCurrentUser } from "@/lib/auth";
import { redirect } from "next/navigation";

export default async function DashboardLayout({ children } : { children: React.ReactNode}) {

  const user = await getCurrentUser()
  
  if(!user){
    redirect("/login")
  }

  return (
    <>
      {children}
    </>
  )
}
</file>

<file path="components/ui/card.tsx">
import * as React from "react"

import { cn } from "@/lib/utils"

function Card({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card"
      className={cn(
        "bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",
        className
      )}
      {...props}
    />
  )
}

function CardHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-header"
      className={cn(
        "@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",
        className
      )}
      {...props}
    />
  )
}

function CardTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-title"
      className={cn("leading-none font-semibold", className)}
      {...props}
    />
  )
}

function CardDescription({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function CardAction({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-action"
      className={cn(
        "col-start-2 row-span-2 row-start-1 self-start justify-self-end",
        className
      )}
      {...props}
    />
  )
}

function CardContent({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-content"
      className={cn("px-6", className)}
      {...props}
    />
  )
}

function CardFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-footer"
      className={cn("flex items-center px-6 [.border-t]:pt-6", className)}
      {...props}
    />
  )
}

export {
  Card,
  CardHeader,
  CardFooter,
  CardTitle,
  CardAction,
  CardDescription,
  CardContent,
}
</file>

<file path="components/ui/input.tsx">
import * as React from "react"

import { cn } from "@/lib/utils"

function Input({ className, type, ...props }: React.ComponentProps<"input">) {
  return (
    <input
      type={type}
      data-slot="input"
      className={cn(
        "file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
        "focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]",
        "aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
        className
      )}
      {...props}
    />
  )
}

export { Input }
</file>

<file path="components/ui/progress.tsx">
"use client"

import * as React from "react"
import { Progress as ProgressPrimitive } from "radix-ui"

import { cn } from "@/lib/utils"

function Progress({
  className,
  value,
  ...props
}: React.ComponentProps<typeof ProgressPrimitive.Root>) {
  return (
    <ProgressPrimitive.Root
      data-slot="progress"
      className={cn(
        "bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",
        className
      )}
      {...props}
    >
      <ProgressPrimitive.Indicator
        data-slot="progress-indicator"
        className="bg-primary h-full w-full flex-1 transition-all"
        style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
      />
    </ProgressPrimitive.Root>
  )
}

export { Progress }
</file>

<file path="components/ui/separator.tsx">
"use client"

import * as React from "react"
import { Separator as SeparatorPrimitive } from "radix-ui"

import { cn } from "@/lib/utils"

function Separator({
  className,
  orientation = "horizontal",
  decorative = true,
  ...props
}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {
  return (
    <SeparatorPrimitive.Root
      data-slot="separator"
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",
        className
      )}
      {...props}
    />
  )
}

export { Separator }
</file>

<file path="eslint.config.mjs">
import { defineConfig, globalIgnores } from "eslint/config";
import nextVitals from "eslint-config-next/core-web-vitals";
import nextTs from "eslint-config-next/typescript";

const eslintConfig = defineConfig([
  ...nextVitals,
  ...nextTs,
  // Override default ignores of eslint-config-next.
  globalIgnores([
    // Default ignores of eslint-config-next:
    ".next/**",
    "out/**",
    "build/**",
    "next-env.d.ts",
  ]),
]);

export default eslintConfig;
</file>

<file path="lib/errors/domain.ts">
/**
 * Base class for all domain-level errors
 * Domain errors represent known failure cases in the system
 */
export abstract class DomainError extends Error {
  abstract code: string;
}

/**
 * Thrown when AI returns invalid or untrusted output
 */
export class AIOutputInvalidError extends DomainError {
  code = "AI_OUTPUT_INVALID";

  constructor(message: string) {
    super(message);
    this.name = "AIOutputInvalidError";
  }
}
</file>

<file path="lib/password.ts">
import bcrypt from "bcryptjs";

const SALT_ROUNDS = 10

export async function hashPassword(password:string) {
  return bcrypt.hash(password, SALT_ROUNDS)
}

export async function verifyPassword(password: string, hashedPassword: string) {
  return bcrypt.compare(password, hashedPassword)
}
</file>

<file path="lib/repositories/course.repo.ts">
import { getPrisma } from "@/lib/db";
import { Prisma } from "@prisma/client";

export const courseRepository = {
  async create(data: {
    title: string;
    level: string;
    outline: Prisma.InputJsonValue;
    ownerId: string;
  }) {
    const prisma = await getPrisma();

    return prisma.course.create({
      data,
    });
  },

  async findAllByOwner(ownerId: string) {
    const prisma = await getPrisma();

    return prisma.course.findMany({
      where: { ownerId },
      orderBy: { createdAt: "desc" },
    });
  },

  async findOwned(courseId: string, ownerId: string) {
    const prisma = await getPrisma();

    return prisma.course.findFirst({
      where: { id: courseId, ownerId },
    });
  },
};
</file>

<file path="lib/session.ts">
import { cookies } from "next/headers";

export const SESSION_KEY = "session_user";


export async function getSessionUserId(){
  const cookie = await cookies()
  return cookie.get(SESSION_KEY)?.value
}
</file>

<file path="postcss.config.mjs">
const config = {
  plugins: {
    "@tailwindcss/postcss": {},
  },
};

export default config;
</file>

<file path="prisma/migrations/20260115194420_init/migration.sql">
-- CreateTable
CREATE TABLE "User" (
    "id" TEXT NOT NULL PRIMARY KEY,
    "email" TEXT NOT NULL,
    "password" TEXT NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- CreateTable
CREATE TABLE "Course" (
    "id" TEXT NOT NULL PRIMARY KEY,
    "title" TEXT NOT NULL,
    "level" TEXT NOT NULL,
    "outline" JSONB NOT NULL,
    "ownerId" TEXT NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT "Course_ownerId_fkey" FOREIGN KEY ("ownerId") REFERENCES "User" ("id") ON DELETE RESTRICT ON UPDATE CASCADE
);

-- CreateIndex
CREATE UNIQUE INDEX "User_email_key" ON "User"("email");
</file>

<file path="prisma/migrations/20260205091441_add_progress_and_status/migration.sql">
-- CreateTable
CREATE TABLE "ChapterProgress" (
    "id" TEXT NOT NULL PRIMARY KEY,
    "userId" TEXT NOT NULL,
    "courseId" TEXT NOT NULL,
    "chapter" INTEGER NOT NULL,
    "completed" BOOLEAN NOT NULL DEFAULT false,
    "updatedAt" DATETIME NOT NULL
);

-- RedefineTables
PRAGMA defer_foreign_keys=ON;
PRAGMA foreign_keys=OFF;
CREATE TABLE "new_Course" (
    "id" TEXT NOT NULL PRIMARY KEY,
    "title" TEXT NOT NULL,
    "level" TEXT NOT NULL,
    "outline" JSONB NOT NULL,
    "ownerId" TEXT NOT NULL,
    "status" TEXT NOT NULL DEFAULT 'CREATING',
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT "Course_ownerId_fkey" FOREIGN KEY ("ownerId") REFERENCES "User" ("id") ON DELETE RESTRICT ON UPDATE CASCADE
);
INSERT INTO "new_Course" ("createdAt", "id", "level", "outline", "ownerId", "title") SELECT "createdAt", "id", "level", "outline", "ownerId", "title" FROM "Course";
DROP TABLE "Course";
ALTER TABLE "new_Course" RENAME TO "Course";
PRAGMA foreign_keys=ON;
PRAGMA defer_foreign_keys=OFF;

-- CreateIndex
CREATE UNIQUE INDEX "ChapterProgress_userId_courseId_chapter_key" ON "ChapterProgress"("userId", "courseId", "chapter");
</file>

<file path="prisma/migrations/migration_lock.toml">
# Please do not edit this file manually
# It should be added in your version-control system (e.g., Git)
provider = "sqlite"
</file>

<file path="public/file.svg">
<svg fill="none" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 13.5V5.41a1 1 0 0 0-.3-.7L9.8.29A1 1 0 0 0 9.08 0H1.5v13.5A2.5 2.5 0 0 0 4 16h8a2.5 2.5 0 0 0 2.5-2.5m-1.5 0v-7H8v-5H3v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1M9.5 5V2.12L12.38 5zM5.13 5h-.62v1.25h2.12V5zm-.62 3h7.12v1.25H4.5zm.62 3h-.62v1.25h7.12V11z" clip-rule="evenodd" fill="#666" fill-rule="evenodd"/></svg>
</file>

<file path="public/globe.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><g clip-path="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.27 14.1a6.5 6.5 0 0 0 3.67-3.45q-1.24.21-2.7.34-.31 1.83-.97 3.1M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.48-1.52a7 7 0 0 1-.96 0H7.5a4 4 0 0 1-.84-1.32q-.38-.89-.63-2.08a40 40 0 0 0 3.92 0q-.25 1.2-.63 2.08a4 4 0 0 1-.84 1.31zm2.94-4.76q1.66-.15 2.95-.43a7 7 0 0 0 0-2.58q-1.3-.27-2.95-.43a18 18 0 0 1 0 3.44m-1.27-3.54a17 17 0 0 1 0 3.64 39 39 0 0 1-4.3 0 17 17 0 0 1 0-3.64 39 39 0 0 1 4.3 0m1.1-1.17q1.45.13 2.69.34a6.5 6.5 0 0 0-3.67-3.44q.65 1.26.98 3.1M8.48 1.5l.01.02q.41.37.84 1.31.38.89.63 2.08a40 40 0 0 0-3.92 0q.25-1.2.63-2.08a4 4 0 0 1 .85-1.32 7 7 0 0 1 .96 0m-2.75.4a6.5 6.5 0 0 0-3.67 3.44 29 29 0 0 1 2.7-.34q.31-1.83.97-3.1M4.58 6.28q-1.66.16-2.95.43a7 7 0 0 0 0 2.58q1.3.27 2.95.43a18 18 0 0 1 0-3.44m.17 4.71q-1.45-.12-2.69-.34a6.5 6.5 0 0 0 3.67 3.44q-.65-1.27-.98-3.1" fill="#666"/></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h16v16H0z"/></clipPath></defs></svg>
</file>

<file path="public/next.svg">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 394 80"><path fill="#000" d="M262 0h68.5v12.7h-27.2v66.6h-13.6V12.7H262V0ZM149 0v12.7H94v20.4h44.3v12.6H94v21h55v12.6H80.5V0h68.7zm34.3 0h-17.8l63.8 79.4h17.9l-32-39.7 32-39.6h-17.9l-23 28.6-23-28.6zm18.3 56.7-9-11-27.1 33.7h17.8l18.3-22.7z"/><path fill="#000" d="M81 79.3 17 0H0v79.3h13.6V17l50.2 62.3H81Zm252.6-.4c-1 0-1.8-.4-2.5-1s-1.1-1.6-1.1-2.6.3-1.8 1-2.5 1.6-1 2.6-1 1.8.3 2.5 1a3.4 3.4 0 0 1 .6 4.3 3.7 3.7 0 0 1-3 1.8zm23.2-33.5h6v23.3c0 2.1-.4 4-1.3 5.5a9.1 9.1 0 0 1-3.8 3.5c-1.6.8-3.5 1.3-5.7 1.3-2 0-3.7-.4-5.3-1s-2.8-1.8-3.7-3.2c-.9-1.3-1.4-3-1.4-5h6c.1.8.3 1.6.7 2.2s1 1.2 1.6 1.5c.7.4 1.5.5 2.4.5 1 0 1.8-.2 2.4-.6a4 4 0 0 0 1.6-1.8c.3-.8.5-1.8.5-3V45.5zm30.9 9.1a4.4 4.4 0 0 0-2-3.3 7.5 7.5 0 0 0-4.3-1.1c-1.3 0-2.4.2-3.3.5-.9.4-1.6 1-2 1.6a3.5 3.5 0 0 0-.3 4c.3.5.7.9 1.3 1.2l1.8 1 2 .5 3.2.8c1.3.3 2.5.7 3.7 1.2a13 13 0 0 1 3.2 1.8 8.1 8.1 0 0 1 3 6.5c0 2-.5 3.7-1.5 5.1a10 10 0 0 1-4.4 3.5c-1.8.8-4.1 1.2-6.8 1.2-2.6 0-4.9-.4-6.8-1.2-2-.8-3.4-2-4.5-3.5a10 10 0 0 1-1.7-5.6h6a5 5 0 0 0 3.5 4.6c1 .4 2.2.6 3.4.6 1.3 0 2.5-.2 3.5-.6 1-.4 1.8-1 2.4-1.7a4 4 0 0 0 .8-2.4c0-.9-.2-1.6-.7-2.2a11 11 0 0 0-2.1-1.4l-3.2-1-3.8-1c-2.8-.7-5-1.7-6.6-3.2a7.2 7.2 0 0 1-2.4-5.7 8 8 0 0 1 1.7-5 10 10 0 0 1 4.3-3.5c2-.8 4-1.2 6.4-1.2 2.3 0 4.4.4 6.2 1.2 1.8.8 3.2 2 4.3 3.4 1 1.4 1.5 3 1.5 5h-5.8z"/></svg>
</file>

<file path="public/vercel.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1155 1000"><path d="m577.3 0 577.4 1000H0z" fill="#fff"/></svg>
</file>

<file path="public/window.svg">
<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.5 2.5h13v10a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1zM0 1h16v11.5a2.5 2.5 0 0 1-2.5 2.5h-11A2.5 2.5 0 0 1 0 12.5zm3.75 4.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5M7 4.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m1.75.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5" fill="#666"/></svg>
</file>

<file path="services/progress.service.ts">
import { getPrisma } from "@/lib/db"


export const progressService =  {
  async toggleChapter(userId: string, courseId: string, chapter: number){
    const prisma = await getPrisma();

    const existing = await prisma.chapterProgress.findUnique({
      where: {
        userId_courseId_chapter: {
          userId,
          courseId,
          chapter,
        },
      }
    })

    if(existing){
      return prisma.chapterProgress.update({
        where: { id: existing.id },
        data: { completed:!existing.completed }
      });
    }

    return prisma.chapterProgress.create({
      data: {
        userId,
        courseId,
        chapter,
        completed: true,
      }
    })
  },

  async getProgress(userId: string, courseId: string){
    const prisma = await getPrisma();

    return prisma.chapterProgress.findMany({
      where: { userId, courseId }
    })
  }
}
</file>

<file path="components/ui/navbar.tsx">
import Link from "next/link";
import { Button } from "@/components/ui/button";

export function Navbar() {
  return (
    <nav className="fixed top-0 w-full z-50 border-b border-white/5 bg-black/60 backdrop-blur-xl">
      <div className="max-w-7xl mx-auto flex items-center justify-between h-20 px-6">
        <Link href="/" className="flex items-center gap-2 group">
          <div className="w-8 h-8 bg-primary rounded-lg flex items-center justify-center group-hover:rotate-12 transition-transform">
            <span className="text-black font-black text-xl">P</span>
          </div>
          <span className="font-bold text-xl tracking-tighter text-white">
            PathForge
          </span>
        </Link>

        <div className="flex items-center gap-6">
          <Link
            href="/login"
            className="text-sm font-medium text-muted-foreground hover:text-white transition-colors"
          >
            Login
          </Link>
          <Link href="/signup">
            <Button className="h-10 px-5 rounded-xl bg-white text-black font-bold hover:bg-gray-200 transition-all">
              Join for Free
            </Button>
          </Link>
        </div>
      </div>
    </nav>
  );
}
</file>

<file path="lib/ai/prompts.ts">
export const COURSE_OUTLINE_PROMPT = ({
  topic,
  level,
  chapters,
  duration,
}: {
  topic: string;
  level: string;
  chapters: string;
  duration: string;
}) => `
Create a structured learning course.

Topic: ${topic}
Level: ${level}

Rules:
- Output ONLY valid JSON
- EXACTLY ${chapters} chapters
- Total course duration is ${duration} minutes
- Divide the total duration reasonably across chapters
- Each chapter MUST include durationMinutes
- No markdown
- No explanations
- No extra fields

JSON format:
{
  "title": string,
  "chapters": [
    {
      "title": string,
      "about": string,
      "durationMinutes": number,
      "youtubeQuery": string
    }
  ]
}


`;
</file>

<file path="prisma/schema.prisma">
// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  courses   Course[]
  createdAt DateTime @default(now())
}

model Course {
  id        String   @id @default(uuid())
  title     String
  level     String
  outline   Json
  ownerId   String
  owner     User     @relation(fields: [ownerId], references: [id])
  status    String   @default("CREATING")
  createdAt DateTime @default(now())
}

model ChapterProgress {
  id        String   @id @default(uuid())
  userId    String
  courseId  String
  chapter   Int
  completed Boolean @default(false)
  updatedAt DateTime @updatedAt

  @@unique([userId, courseId, chapter])
}
</file>

<file path="README.md">
# AI Course Generator

A full-stack AI-powered application that generates structured learning paths based on user input.

## Tech Stack
- Next.js (App Router, Server Actions)
- TypeScript
- Prisma ORM (SQLite)
- Gemini AI API
- Zod (Validation)
- YouTube Data API

## Features
- AI-generated course outlines with strict schema validation
- Secure authentication using HTTP-only cookies
- User-specific course ownership
- Automatic YouTube video suggestions for each chapter
- Clean service & repository-based architecture

## My Role
- Designed full-stack architecture with Next.js App Router
- Integrated Gemini AI with validated JSON output handling
- Implemented secure authentication and protected routes
- Built scalable database models using Prisma

## Status
Project is under active development.
</file>

<file path=".gitignore">
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# env files (can opt-in for committing if needed)
.env*

# vercel
.vercel

# typescript
*.tsbuildinfo
next-env.d.ts

# Prisma
prisma/dev.db
prisma/dev.db-journal
node_modules/.prisma
</file>

<file path="app/(course)/courses/[courseId]/page.tsx">
import { redirect } from "next/navigation";

export default async function CourseIndexPage({
  params,
}: {
  params: Promise<{ courseId: string }>;
}) {
  const { courseId } = await params;

  redirect(`/courses/${courseId}/0`);
}
</file>

<file path="app/(dashboard)/create-course/SubmitButton.tsx">
'use client'
import { useFormStatus } from 'react-dom'
import { Sparkles, Loader2 } from 'lucide-react'

const SubmitButton = () => {
  const { pending } = useFormStatus();
  
  return (
    <button 
      type='submit' 
      disabled={pending} 
      className={`w-full py-4 rounded-xl font-bold text-sm transition-all flex items-center justify-center gap-2 shadow-xl 
        ${pending 
          ? "bg-white/10 text-muted-foreground cursor-wait" 
          : "bg-primary text-black hover:scale-[1.01] hover:shadow-primary/25 active:scale-[0.98] cursor-pointer"
        }`}
    >
      {pending ? (
        <>
          <Loader2 className="w-4 h-4 animate-spin" />
          AI is forging your course...
        </>
      ) : (
        <>
          <Sparkles className="w-4 h-4" />
          Generate Learning Path
        </>
      )}
    </button>
  )
}

export default SubmitButton;
</file>

<file path="app/(marketing)/login/page.tsx">
"use client";
import { AuthState, login } from "@/actions/auth";
import Link from "next/link";
import { useActionState } from "react";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Sparkles } from "lucide-react";

export default function LoginPage() {
  const [state, formAction] = useActionState(login, { error: null });

  return (
    <div className="min-h-screen bg-[#050505] flex flex-col justify-center items-center px-4">
      <div className="absolute inset-0 bg-[radial-gradient(circle_at_center,rgba(16,185,129,0.08),transparent_70%)]" />
      
      <div className="w-full max-w-md z-10">
        <div className="text-center mb-10">
          <div className="inline-flex p-3 bg-primary/10 rounded-2xl mb-4">
            <Sparkles className="w-6 h-6 text-primary" />
          </div>
          <h1 className="text-3xl font-bold tracking-tight text-white">Welcome Back</h1>
          <p className="text-muted-foreground mt-2">Sign in to continue your learning journey.</p>
        </div>

        <div className="bg-card border border-white/5 p-8 rounded-3xl shadow-2xl backdrop-blur-sm">
          <form action={formAction} className="space-y-5">
            <div className="space-y-2">
              <label className="text-xs font-semibold uppercase tracking-widest text-gray-500 ml-1">Email</label>
              <Input 
                name="email" 
                type="email" 
                placeholder="name@example.com" 
                className="bg-white/5 border-white/10 h-12 rounded-xl focus:ring-primary/50" 
                required 
              />
            </div>

            <div className="space-y-2">
              <label className="text-xs font-semibold uppercase tracking-widest text-gray-500 ml-1">Password</label>
              <Input 
                name="password" 
                type="password" 
                placeholder="••••••••" 
                className="bg-white/5 border-white/10 h-12 rounded-xl focus:ring-primary/50" 
                required 
              />
            </div>

            {state?.error && (
              <p className="text-sm text-red-500 bg-red-500/10 p-3 rounded-lg border border-red-500/20 text-center">
                {state.error}
              </p>
            )}

            <Button className="w-full h-12 rounded-xl font-bold text-black bg-primary hover:bg-primary/90 transition-all shadow-lg shadow-primary/20">
              Sign In
            </Button>
          </form>

          <div className="mt-8 pt-6 border-t border-white/5 text-center">
            <p className="text-sm text-muted-foreground">
              New to PathForge?{" "}
              <Link href="/signup" className="text-primary hover:underline font-medium">Create account</Link>
            </p>
          </div>
        </div>
      </div>
    </div>
  );
}
</file>

<file path="components.json">
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": true,
  "tsx": true,
  "tailwind": {
    "config": "",
    "css": "app/globals.css",
    "baseColor": "neutral",
    "cssVariables": true,
    "prefix": ""
  },
  "iconLibrary": "lucide",
  "rtl": false,
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "registries": {}
}
</file>

<file path="components/ui/button.tsx">
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"
import { Slot } from "radix-ui"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost:
          "hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2 has-[>svg]:px-3",
        xs: "h-6 gap-1 rounded-md px-2 text-xs has-[>svg]:px-1.5 [&_svg:not([class*='size-'])]:size-3",
        sm: "h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",
        lg: "h-10 rounded-md px-6 has-[>svg]:px-4",
        icon: "size-9",
        "icon-xs": "size-6 rounded-md [&_svg:not([class*='size-'])]:size-3",
        "icon-sm": "size-8",
        "icon-lg": "size-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Button({
  className,
  variant = "default",
  size = "default",
  asChild = false,
  ...props
}: React.ComponentProps<"button"> &
  VariantProps<typeof buttonVariants> & {
    asChild?: boolean
  }) {
  const Comp = asChild ? Slot.Root : "button"

  return (
    <Comp
      data-slot="button"
      data-variant={variant}
      data-size={size}
      className={cn(buttonVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Button, buttonVariants }
</file>

<file path="lib/ai/parser.ts">
import { AIOutputInvalidError } from "../errors/domain";
import { CourseOutlineSchema } from "./schema";

export function parseCourseOutline(rawText: string) {
  let parsed: unknown;

  try {
    parsed = JSON.parse(rawText);
  } catch {
    throw new AIOutputInvalidError("AI returned invalid JSON");
  }

  const result = CourseOutlineSchema.safeParse(parsed);

  if (!result.success) {
    console.error(
      "AI SCHEMA ERROR:",
      JSON.stringify(result.error.format(), null, 2),
    );

    throw new AIOutputInvalidError(
      "AI output does not match CourseOutlineSchema",
    );
  }

  return result.data;
}
</file>

<file path="lib/auth.ts">
import { getPrisma } from "./db";
import { getSessionUserId } from "./session";

export async function getCurrentUser() {
  const userId = await getSessionUserId();
  if (!userId) return null;

  const prisma = await getPrisma();

  return prisma.user.findUnique({
    where: { id: userId}
  })
}
</file>

<file path="lib/db.ts">
import type { PrismaClient as PrismaClientType } from "@prisma/client";

let prisma: PrismaClientType | null = null;

export async function getPrisma() {
  if (prisma) return prisma;

  const { PrismaClient } = await import("@prisma/client");
  prisma = new PrismaClient({
    log: ["error"],
  });

  return prisma;
}
</file>

<file path="lib/utils.ts">
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
</file>

<file path="next.config.ts">
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  /* config options here */
};

export default nextConfig;
</file>

<file path="services/auth.service.ts">
import { getPrisma } from "@/lib/db"
import { hashPassword, verifyPassword } from "@/lib/password"

export const authService = {
  async signup(email: string, password: string) {
    const prisma = await getPrisma()

    const exists = await prisma.user.findUnique({
      where: { email }
    })
    if(exists){
      throw new Error("User already exists")
    }
    
    const hashedPassword = await hashPassword(password);

    const user = await prisma.user.create({
      data: {
        email,
        password: hashedPassword
      }
    })

    return user;
  },

  async login(email: string, password: string){
    const prisma = await getPrisma()
    const user = await prisma.user.findUnique({
      where: { email }
    })

    if(!user){
      throw new Error("Invalid credentials")
    }

    const isPassValid = await verifyPassword(password, user.password)

    if(!isPassValid){
      throw new Error("Invalid Password")
    }

    return user;
  },

}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  "exclude": ["node_modules"]
}
</file>

<file path="lib/ai/schema.ts">
import { z } from "zod";

export const ChapterSchema = z.object({
  title: z.string().min(3),
  about: z.string().min(10),
  durationMinutes: z.number().int().positive(),
  youtubeQuery: z.string().min(5),
  youtubeVideoId: z.string().optional(),
});

export const CourseOutlineSchema = z.object({
  title: z.string().min(3),
  chapters: z.array(ChapterSchema).min(1),
});

export type CourseOutline = z.infer<typeof CourseOutlineSchema>;
</file>

<file path="services/ai.service.ts">
import { CreateCourseInput } from "@/actions/createCourse.schema";
import { parseCourseOutline } from "@/lib/ai/parser";
import { COURSE_OUTLINE_PROMPT } from "@/lib/ai/prompts";
import { CourseOutline } from "@/lib/ai/schema";
import { GoogleGenerativeAI } from "@google/generative-ai";

const apiKey = process.env.GEMINI_API_KEY;

if (!apiKey) {
  throw new Error("Missing Gemini API key");
}

const genAI = new GoogleGenerativeAI(apiKey);

export const aiService = {
  async generateCourseOutline(
    input: CreateCourseInput,
  ): Promise<CourseOutline> {
    const model = genAI.getGenerativeModel({
      model: "gemini-2.5-flash",
    });

    const result = await model.generateContent(
      COURSE_OUTLINE_PROMPT({
        topic: input.topic,
        level: input.level,
        chapters: input.chapters,
        duration: input.duration,
      }),
    );
    const text = result.response.text();

    const cleaned = text
      .replace(/```json/g, "")
      .replace(/```/g, "")
      .trim();

    return parseCourseOutline(cleaned);
  },
};
</file>

<file path="services/youtube.service.ts">
const YOUTUBE_API_KEY = process.env.YOUTUBE_API_KEY;
if(!YOUTUBE_API_KEY){
  throw new Error("Missing Youtube API Key")
}
const BASE_URL = "https://www.googleapis.com/youtube/v3/search";

export type YouTubeVideo = {
  videoId: string;
  title: string;
};

export const youtubeService = {
  async searchTopVideo(query: string): Promise<YouTubeVideo | null> {
    if (!YOUTUBE_API_KEY) return null;
    
    const url = new URL(BASE_URL);
    url.searchParams.set("key", YOUTUBE_API_KEY);
    url.searchParams.set("part", "snippet");
    url.searchParams.set("q", query);
    url.searchParams.set("type", "video");
    url.searchParams.set("maxResults", "1");

    const res = await fetch(url.toString());

    if (!res.ok) {
      throw new Error("YouTube API request failed");
    }

    const data = await res.json();

    const item = data.items?.[0];
    if (!item) return null;

    return {
      videoId: item.id.videoId,
      title: item.snippet.title,
    };
  },
};
</file>

<file path="actions/createCourse.ts">
"use server";
import { courseService } from "@/services/course.service";
import { redirect } from "next/navigation";
import { createCourseSchema } from "./createCourse.schema";
import { getCurrentUser } from "@/lib/auth";

export type FormState = {
  error?: string;
};

export async function createCourse(
  prevState: FormState,
  formData: FormData,
): Promise<FormState> {
  const rawData = {
    topic: formData.get("topic"),
    level: formData.get("level"),
    chapters: formData.get("chapters"),
    duration: formData.get("duration"),
  };

  const user = await getCurrentUser();

  if (!user) {
    return { error: "Unauthorized" };
  }

  const parsed = createCourseSchema.safeParse(rawData);

  if (!parsed.success) {
    return {
      error: parsed.error.message,
    };
  }
  const data = parsed.data;

  try {
    await courseService.create(data, user);
    redirect("/dashboard");
  } catch (err) {
    if (err instanceof Error && err.message === "NEXT_REDIRECT") {
      throw err;
    }

    console.error("CREATE COURSE FAILED:", err);

    return {
      error: "AI failed to generate the course. Please try again.",
    };
  }
}
</file>

<file path="app/(dashboard)/create-course/page.tsx">
"use client";
import { createCourse, FormState } from "@/actions/createCourse";
import { useActionState } from "react";
import SubmitButton from "./SubmitButton";
import Link from "next/link";
import { ChevronLeft, Sparkles, Layout, Clock, BarChart } from "lucide-react";

const page = () => {
  const [state, formAction] = useActionState(createCourse, {});

  return (
    <div className="min-h-screen bg-[#050505] py-16 px-4">
      <div className="max-w-2xl mx-auto">
        <Link
          href="/dashboard"
          className="inline-flex items-center text-sm text-muted-foreground hover:text-primary transition-colors mb-8"
        >
          <ChevronLeft className="w-4 h-4 mr-1" /> Back to Dashboard
        </Link>

        <div className="bg-card border border-white/5 rounded-3xl p-8 shadow-2xl relative overflow-hidden">
          {/* Decorative Background Glow */}
          <div className="absolute top-0 right-0 -mr-20 -mt-20 w-64 h-64 bg-primary/10 rounded-full blur-[100px]" />

          <div className="relative z-10">
            <div className="flex items-center gap-3 mb-2">
              <div className="p-2 bg-primary/10 rounded-lg">
                <Sparkles className="w-5 h-5 text-primary" />
              </div>
              <h1 className="text-3xl font-bold tracking-tight">
                Generate Course
              </h1>
            </div>
            <p className="text-muted-foreground mb-8">
              Describe your topic and let AI forge a custom learning path for
              you.
            </p>

            <form action={formAction} className="space-y-6">
              <div className="space-y-2">
                <label className="text-sm font-medium flex items-center gap-2">
                  <Layout className="w-4 h-4 text-primary" /> Topic or Skill
                </label>
                <input
                  id="topic"
                  name="topic"
                  placeholder="e.g. Advanced React Patterns or Italian Cooking"
                  required
                  className="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all"
                />
              </div>

              <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div className="space-y-2">
                  <label className="text-sm font-medium flex items-center gap-2">
                    <BarChart className="w-4 h-4 text-primary" /> Level
                  </label>
                  <select
                    name="level"
                    className="w-full bg-white/5 border border-white/10 rounded-xl px-3 py-3 text-sm focus:ring-2 focus:ring-primary/50 outline-none"
                  >
                    <option value="beginner">Beginner</option>
                    <option value="intermediate">Intermediate</option>
                    <option value="advanced">Advanced</option>
                  </select>
                </div>

                <div className="space-y-2">
                  <label className="text-sm font-medium flex items-center gap-2">
                    <Layout className="w-4 h-4 text-primary" /> Chapters
                  </label>
                  <select
                    name="chapters"
                    className="w-full bg-white/5 border border-white/10 rounded-xl px-3 py-3 text-sm focus:ring-2 focus:ring-primary/50 outline-none"
                  >
                    <option value="5">5 Modules</option>
                    <option value="8">8 Modules</option>
                    <option value="12">12 Modules</option>
                  </select>
                </div>

                <div className="space-y-2">
                  <label className="text-sm font-medium flex items-center gap-2">
                    <Clock className="w-4 h-4 text-primary" /> Duration
                  </label>
                  <select
                    name="duration"
                    className="w-full bg-white/5 border border-white/10 rounded-xl px-3 py-3 text-sm focus:ring-2 focus:ring-primary/50 outline-none"
                  >
                    <option value="30">30 min</option>
                    <option value="60">60 min</option>
                    <option value="90">90 min</option>
                  </select>
                </div>
              </div>

              {state?.error && (
                <div className="p-3 bg-destructive/10 border border-destructive/20 rounded-lg">
                  <p className="text-xs text-destructive text-center">
                    {state.error}
                  </p>
                </div>
              )}

              <div className="pt-4">
                <SubmitButton />
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  );
};

export default page;
</file>

<file path="app/(marketing)/signup/page.tsx">
"use client";
import { AuthState, Signup } from "@/actions/auth";
import Link from "next/link";
import { useActionState } from "react";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { UserPlus, Sparkles } from "lucide-react";

export default function SignupPage() {
  const [state, formAction] = useActionState(Signup, { error: null });

  return (
    <div className="min-h-screen bg-[#050505] flex items-center justify-center px-4 relative overflow-hidden">
      {/* Background Glow */}
      <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-125 h-125 bg-primary/10 rounded-full blur-[120px] pointer-events-none" />

      <div className="w-full max-w-md relative z-10">
        <div className="text-center mb-8">
          <div className="inline-flex p-3 bg-primary/10 rounded-2xl mb-4">
            <UserPlus className="w-6 h-6 text-primary" />
          </div>
          <h1 className="text-3xl font-bold tracking-tight text-white">Forge your path</h1>
          <p className="text-muted-foreground mt-2 text-sm">Join PathForge and start learning with AI</p>
        </div>

        <div className="bg-card/50 border border-white/5 p-8 rounded-3xl backdrop-blur-xl shadow-2xl">
          <form action={formAction} className="space-y-4">
            <div className="space-y-2">
              <label className="text-[10px] uppercase tracking-widest font-bold text-muted-foreground ml-1">Email Address</label>
              <Input 
                name="email" 
                type="email" 
                placeholder="name@example.com"
                className="bg-white/5 border-white/10 h-12 rounded-xl focus:ring-primary/50 transition-all outline-none"
                required 
              />
            </div>

            <div className="space-y-2">
              <label className="text-[10px] uppercase tracking-widest font-bold text-muted-foreground ml-1">Create Password</label>
              <Input 
                name="password" 
                type="password" 
                placeholder="••••••••"
                className="bg-white/5 border-white/10 h-12 rounded-xl focus:ring-primary/50 transition-all outline-none"
                required 
              />
            </div>

            {state?.error && (
              <div className="p-3 bg-destructive/10 border border-destructive/20 rounded-xl text-destructive text-xs text-center animate-in fade-in zoom-in-95">
                {state.error}
              </div>
            )}

            <Button className="w-full h-12 bg-primary text-black font-bold rounded-xl hover:bg-primary/90 transition-all mt-4 shadow-lg shadow-primary/20 group">
              <span className="flex items-center gap-2">
                Create Account <Sparkles className="w-4 h-4 group-hover:rotate-12 transition-transform" />
              </span>
            </Button>
          </form>

          <div className="mt-8 pt-6 border-t border-white/5 text-center">
            <p className="text-sm text-muted-foreground">
              Already have an account?{" "}
              <Link href="/login" className="text-primary font-bold hover:underline">Sign in</Link>
            </p>
          </div>
        </div>
      </div>
    </div>
  );
}
</file>

<file path="services/course.service.ts">
import { aiService } from "./ai.service";
import { courseRepository } from "@/lib/repositories/course.repo";
import { CourseOutline, CourseOutlineSchema } from "@/lib/ai/schema";
import { User } from "@prisma/client";
import { CreateCourseInput } from "@/actions/createCourse.schema";
import { youtubeService } from "./youtube.service";

export type Course = {
  id: string;
  title: string;
  level: string;
  outline: CourseOutline;
  ownerId: string;
};

export const courseService = {
  async create(data: CreateCourseInput, user: User) {
    const outline = await aiService.generateCourseOutline(data);

    const videoChapters = await Promise.all(
      outline.chapters.map(async (chapter) => {
        try{
          const video = await youtubeService.searchTopVideo(chapter.youtubeQuery)
          return {
            ...chapter,
            youtubeVideoId: video?.videoId
          }
        } catch {
          return chapter;
        }
      })
    )

    const finalOutline: CourseOutline = {
      ...outline,
      chapters: videoChapters,
    };

    return courseRepository.create({
      title: finalOutline.title,
      level: data.level,
      outline: finalOutline,
      ownerId: user.id,
    });
  },

  async getAllForUser(user: User) {
    const courses = await courseRepository.findAllByOwner(user.id);

    return courses.map((course) => ({
      ...course,
      outline: CourseOutlineSchema.parse(course.outline),
    }));
  },

  async getById(courseId: string, user: User) {
    const course = await courseRepository.findOwned(courseId, user.id);

    if (!course) {
      throw new Error("Course not found");
    }

    return {
      ...course,
      outline: CourseOutlineSchema.parse(course.outline),
    };
  },
};
</file>

<file path="app/(course)/courses/[courseId]/layout.tsx">
import { courseService } from "@/services/course.service";
import { getCurrentUser } from "@/lib/auth";
import { redirect } from "next/navigation";
import Link from "next/link";
import { progressService } from "@/services/progress.service";
import { Progress } from "@/components/ui/progress";
import { Button } from "@/components/ui/button";
import { ChevronLeft } from "lucide-react";
import SidebarNav from "../[courseId]/SidebarNav";

export default async function CourseLayout({
  children,
  params,
}: {
  children: React.ReactNode;
  params: Promise<{ courseId: string }>;
}) {
  const { courseId } = await params;
  const user = await getCurrentUser();
  if (!user) redirect("/login");

  const course = await courseService.getById(courseId, user);
  const progress = await progressService.getProgress(user.id, courseId);
  
  const completedSet = new Set(
    progress.filter((p) => p.completed).map((p) => p.chapter),
  );

  const total = course.outline.chapters.length;
  const completedCount = completedSet.size;
  const progressPercentage = Math.round((completedCount / total) * 100);

  return (
    <div className="flex min-h-screen bg-[#050505]">
      <aside className="w-80 border-r border-white/5 bg-[#0A0A0A] flex flex-col fixed h-full z-20">
        <div className="p-6 border-b border-white/5">
          <Link href="/dashboard">
            <Button variant="ghost" size="sm" className="mb-4 -ml-2 text-muted-foreground hover:text-primary transition-colors">
              <ChevronLeft className="w-4 h-4 mr-1" /> Library
            </Button>
          </Link>
          <h2 className="font-bold text-lg text-white line-clamp-2 mb-4 leading-tight">{course.title}</h2>
          <div className="space-y-2">
            <div className="flex justify-between text-[10px] uppercase tracking-widest text-muted-foreground font-bold">
              <span>Progress</span>
              <span className="text-primary">{progressPercentage}%</span>
            </div>
            <Progress value={progressPercentage} className="h-1.5 bg-white/5" />
          </div>
        </div>

        <nav className="flex-1 overflow-y-auto p-4 custom-scrollbar">
          {/* Use the new Client Component here */}
          <SidebarNav 
            courseId={courseId} 
            chapters={course.outline.chapters} 
            completedSet={completedSet} 
          />
        </nav>
      </aside>

      <main className="flex-1 ml-80 bg-[radial-gradient(circle_at_top_right,rgba(16,185,129,0.03),transparent_40%)]">
        <div className="max-w-4xl mx-auto px-12 py-12">
          {children}
        </div>
      </main>
    </div>
  );
}
</file>

<file path="app/(course)/courses/[courseId]/[chapterId]/page.tsx">
import { courseService } from "@/services/course.service";
import { getCurrentUser } from "@/lib/auth";
import { redirect } from "next/navigation";
import { toggleProgress } from "@/actions/toggleProgress";
import { progressService } from "@/services/progress.service";
import { Button } from "@/components/ui/button";
import { Check, RotateCcw, Clock } from "lucide-react";

export default async function ChapterPage({
  params,
}: {
  params: Promise<{ courseId: string; chapterId: string }>;
}) {
  const { courseId, chapterId } = await params;

  const user = await getCurrentUser();
  if (!user) redirect("/login");

  const course = await courseService.getById(courseId, user);
  const index = Number(chapterId);
  const chapter = course.outline.chapters[index];

  if (!chapter) redirect(`/courses/${courseId}/0`);

  // Check if this specific chapter is completed
  const progress = await progressService.getProgress(user.id, courseId);
  const isCompleted = progress.some((p) => p.chapter === index && p.completed);

  return (
    <div className="max-w-4xl animate-in fade-in slide-in-from-bottom-3 duration-500">
      <div className="flex items-center gap-3 mb-6">
        <span className="bg-primary/10 text-primary px-3 py-1 rounded-full text-xs font-bold uppercase tracking-tighter">
          Module {index + 1}
        </span>
        <span className="flex items-center gap-1 text-muted-foreground text-sm">
          <Clock className="w-4 h-4" /> {chapter.durationMinutes} mins
        </span>
      </div>

      <h1 className="text-4xl font-bold mb-4 text-white tracking-tight">{chapter.title}</h1>
      <p className="text-lg text-muted-foreground mb-8 leading-relaxed">{chapter.about}</p>

      <div className="relative aspect-video w-full rounded-2xl overflow-hidden border border-white/5 shadow-2xl bg-black mb-10">
        {chapter.youtubeVideoId ? (
          <iframe
            className="w-full h-full"
            src={`https://www.youtube.com/embed/${chapter.youtubeVideoId}?rel=0`}
            title={chapter.title}
            allowFullScreen
          />
        ) : (
          <div className="flex flex-col items-center justify-center h-full text-muted-foreground">
            <p>Video loading or unavailable</p>
          </div>
        )}
      </div>

      <div className="flex justify-end pt-6 border-t border-white/5">
        <form action={async () => {
          "use server";
          await toggleProgress(courseId, index);
          redirect(`/courses/${courseId}/${index}`);
        }}>
          <Button
            size="lg"
            variant={isCompleted ? "outline" : "default"}
            className={`h-14 px-8 rounded-xl font-bold transition-all cursor-pointer ${
              isCompleted 
                ? "border-primary/20 text-primary hover:bg-primary/5" 
                : "bg-primary text-black hover:scale-[1.02]"
            }`}
          >
            {isCompleted ? (
              <span className="flex items-center gap-2">
                <RotateCcw className="w-5 h-5" /> Unmark as Complete
              </span>
            ) : (
              <span className="flex items-center gap-2">
                <Check className="w-5 h-5" /> Mark as Complete
              </span>
            )}
          </Button>
        </form>
      </div>
    </div>
  );
}
</file>

<file path="app/(dashboard)/dashboard/page.tsx">
import { logout } from "@/actions/logout";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { getCurrentUser } from "@/lib/auth";
import { courseService } from "@/services/course.service";
import Link from "next/link";
import { redirect } from "next/navigation";
import { Plus, BookOpen, LogOut, Search } from "lucide-react";
import { Button } from "@/components/ui/button";

const page = async () => {
  const user = await getCurrentUser();
  if (!user) redirect("/login");
  const courses = await courseService.getAllForUser(user);

  return (
    <div className="min-h-screen bg-[#050505]">
      {/* Top Navigation */}
      <header className="border-b border-white/5 bg-black/50 backdrop-blur-md sticky top-0 z-50">
        <div className="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
          <div className="flex items-center gap-8">
            <h1 className="text-xl font-bold tracking-tighter text-primary">
              PATHFORGE
            </h1>
            <nav className="hidden md:flex items-center gap-6 text-sm font-medium text-muted-foreground">
              <Link href="/dashboard" className="text-white">
                My Library
              </Link>
              <Link
                href="/create-course"
                className="hover:text-white transition-colors"
              >
                Generator
              </Link>
            </nav>
          </div>
          <form action={logout}>
            <button className="flex items-center gap-2 text-sm text-muted-foreground hover:text-destructive transition-colors px-3 py-2 rounded-lg hover:bg-destructive/5">
              <LogOut className="w-4 h-4" /> Logout
            </button>
          </form>
        </div>
      </header>

      <main className="max-w-7xl mx-auto px-6 py-12">
        {/* Welcome Header */}
        <div className="flex flex-col md:flex-row md:items-end justify-between gap-6 mb-12">
          <div>
            <h2 className="text-4xl font-bold tracking-tight mb-2">
              My Library
            </h2>
            <p className="text-muted-foreground">
              Welcome back,{" "}
              <span className="text-white font-medium">
                {user.email.split("@")[0]}
              </span>
              . Ready to learn?
            </p>
          </div>
          <Link href="/create-course">
            <Button className="h-12 px-6 rounded-xl font-bold shadow-lg shadow-primary/20 hover:scale-[1.02] transition-transform">
              <Plus className="w-5 h-5 mr-2" /> New Course
            </Button>
          </Link>
        </div>

        {/* Course Grid */}
        {courses.length === 0 ? (
          <div className="flex flex-col items-center justify-center py-20 border-2 border-dashed border-white/5 rounded-3xl bg-white/2">
            <div className="p-4 bg-primary/10 rounded-full mb-4">
              <BookOpen className="w-8 h-8 text-primary" />
            </div>
            <h3 className="text-xl font-semibold mb-1">
              Your library is empty
            </h3>
            <p className="text-muted-foreground mb-6">
              Start by generating your first AI-powered course.
            </p>
            <Link href="/create-course">
              <Button variant="outline" className="rounded-xl">
                Create Course
              </Button>
            </Link>
          </div>
        ) : (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {courses.map((course) => (
              <Link
                href={`/courses/${course.id}`}
                key={course.id}
                className="group"
              >
                <Card className="h-full bg-white/3 border-white/5 hover:border-primary/50 hover:bg-white/5 transition-all duration-300 rounded-2xl overflow-hidden relative">
                  <div className="absolute top-0 right-0 p-4 opacity-20 group-hover:opacity-100 transition-opacity">
                    <div className="w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center">
                      <Plus className="w-4 h-4 text-primary" />
                    </div>
                  </div>
                  <CardHeader className="pb-2">
                    <div className="text-[10px] uppercase tracking-widest text-primary font-bold mb-1">
                      {course.level}
                    </div>
                    <CardTitle className="text-xl group-hover:text-primary transition-colors">
                      {course.title}
                    </CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p className="text-sm text-muted-foreground line-clamp-2 mb-4">
                      {/* Note: In your actual app, you might want to show total chapters here */}
                      {(course.outline as any).chapters?.length || 0} Modules •
                      Structured Learning
                    </p>
                    <div className="flex items-center gap-2 pt-2 border-t border-white/5">
                      <div className="w-full bg-white/5 h-1 rounded-full overflow-hidden">
                        <div className="bg-primary h-full w-[10%]" />{" "}
                        {/* Static placeholder, you can map real progress here */}
                      </div>
                    </div>
                  </CardContent>
                </Card>
              </Link>
            ))}
          </div>
        )}
      </main>
    </div>
  );
};

export default page;
</file>

<file path="app/layout.tsx">
import type { Metadata } from "next";
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata: Metadata = {
  title: "PathForge",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en" className="dark">
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased`}
      >
        {children}
      </body>
    </html>
  );
}
</file>

<file path="package.json">
{
  "name": "ai-course-builder",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "cross-env NEXT_DISABLE_TURBOPACK=1 next dev",
    "build": "next build",
    "start": "next start",
    "lint": "eslint"
  },
  "dependencies": {
    "@google/generative-ai": "^0.24.1",
    "@prisma/client": "^6.19.2",
    "bcrypt": "^6.0.0",
    "bcryptjs": "^3.0.3",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "lucide-react": "^0.563.0",
    "next": "16.1.1",
    "prisma": "^6.19.2",
    "radix-ui": "^1.4.3",
    "react": "19.2.3",
    "react-dom": "19.2.3",
    "tailwind-merge": "^3.4.0",
    "zod": "^4.3.5"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/bcryptjs": "^2.4.6",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "cross-env": "^10.1.0",
    "eslint": "^9",
    "eslint-config-next": "16.1.1",
    "shadcn": "^3.8.4",
    "tailwindcss": "^4",
    "tw-animate-css": "^1.4.0",
    "typescript": "^5"
  }
}
</file>

<file path="app/globals.css">
@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

:root {
  --radius: 0.75rem;
}

/* Replace your .dark section in app/globals.css */
.dark {
  --background: 240 10% 3.9%;
  --foreground: 0 0% 98%;

  --card: 240 10% 5%;
  --card-foreground: 0 0% 98%;

  --primary: 158 94% 30%; /* More vibrant Emerald */
  --primary-foreground: 144 100% 5%;

  --secondary: 240 3.7% 15.9%;
  --secondary-foreground: 0 0% 98%;

  --muted: 240 3.7% 10%;
  --muted-foreground: 240 5% 64.9%;

  --border: 240 3.7% 12%;
  --ring: 158 94% 30%;
}

.custom-scrollbar::-webkit-scrollbar {
  width: 4px;
}
.custom-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}
.custom-scrollbar::-webkit-scrollbar-thumb {
  background: #222;
  border-radius: 10px;
}

/*TAILWIND V4 THEME TOKENS*/

@theme {
  --color-background: hsl(var(--background));
  --color-foreground: hsl(var(--foreground));

  --color-card: hsl(var(--card));
  --color-card-foreground: hsl(var(--card-foreground));

  --color-primary: hsl(var(--primary));
  --color-primary-foreground: hsl(var(--primary-foreground));

  --color-secondary: hsl(var(--secondary));
  --color-secondary-foreground: hsl(var(--secondary-foreground));

  --color-muted: hsl(var(--muted));
  --color-muted-foreground: hsl(var(--muted-foreground));

  --color-border: hsl(var(--border));
  --color-ring: hsl(var(--ring));

  --radius-lg: var(--radius);
}

/*BASE STYLES*/

@layer base {
  * {
    border-color: var(--color-border);
  }

  body {
    background-color: var(--color-background);
    color: var(--color-foreground);
    font-feature-settings: "ss01", "ss02";
  }
}
</file>

<file path="app/page.tsx">
import { Button } from "@/components/ui/button";
import { Navbar } from "@/components/ui/navbar";
import Link from "next/link";
import { Sparkles, Youtube, BarChart3, ShieldCheck, Zap, ArrowRight } from "lucide-react";

export default function HomePage() {
  return (
    <main className="relative min-h-screen bg-[#050505] overflow-x-hidden">
      <Navbar />
      
      {/* Immersive Background Glows */}
      <div className="absolute top-0 left-1/2 -translate-x-1/2 w-full h-150 bg-[radial-gradient(circle_at_center,rgba(16,185,129,0.08),transparent_70%)] -z-10" />
      <div className="absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-primary/5 rounded-full blur-[120px] -z-10" />

      <section className="max-w-6xl mx-auto px-6 pt-32 pb-20 text-center">
        {/* Badge */}
        <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10 mb-8 animate-in fade-in slide-in-from-bottom-2 duration-1000">
          <Sparkles className="w-3.5 h-3.5 text-primary" />
          <span className="text-[11px] font-bold uppercase tracking-widest text-primary">Powered by Gemini 2.0</span>
        </div>

        <h1 className="text-5xl md:text-7xl font-bold tracking-tight text-white mb-6 leading-[1.1]">
          Stop searching. <br />
          <span className="text-transparent bg-clip-text bg-linear-to-r from-primary to-emerald-400">Start mastering.</span>
        </h1>

        <p className="max-w-2xl mx-auto text-lg md:text-xl text-muted-foreground mb-10 leading-relaxed">
          PathForge transforms any topic into a structured learning journey. We handle the curation; you handle the growth.
        </p>

        <div className="flex flex-col sm:flex-row justify-center gap-4 mb-20">
          <Link href="/signup">
            <Button size="lg" className="h-14 px-8 rounded-2xl bg-primary text-black font-bold text-md hover:scale-[1.02] transition-all shadow-xl shadow-primary/20">
              Get Started for Free <ArrowRight className="ml-2 w-5 h-5" />
            </Button>
          </Link>
          <Link href="/login">
            <Button size="lg" variant="outline" className="h-14 px-8 rounded-2xl border-white/10 bg-white/5 hover:bg-white/10 font-bold text-md transition-all">
              View Demo
            </Button>
          </Link>
        </div>

        {/* Feature Bento Grid */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 text-left">
          <div className="p-8 rounded-3xl bg-white/3 border border-white/5 hover:border-primary/20 transition-all group">
            <div className="w-12 h-12 rounded-2xl bg-primary/10 flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
              <Zap className="w-6 h-6 text-primary" />
            </div>
            <h3 className="text-xl font-bold text-white mb-3">AI Path Generation</h3>
            <p className="text-muted-foreground text-sm leading-relaxed">
              Tell us what you want to learn. Our AI builds a logical, step-by-step roadmap tailored to your level.
            </p>
          </div>

          <div className="p-8 rounded-3xl bg-white/3 border border-white/5 hover:border-primary/20 transition-all group">
            <div className="w-12 h-12 rounded-2xl bg-red-500/10 flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
              <Youtube className="w-6 h-6 text-red-500" />
            </div>
            <h3 className="text-xl font-bold text-white mb-3">Curated Content</h3>
            <p className="text-muted-foreground text-sm leading-relaxed">
              No more random searching. We fetch the highest-rated YouTube tutorials for every single chapter.
            </p>
          </div>

          <div className="p-8 rounded-3xl bg-white/3 border border-white/5 hover:border-primary/20 transition-all group">
            <div className="w-12 h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center mb-6 group-hover:scale-110 transition-transform">
              <BarChart3 className="w-6 h-6 text-blue-500" />
            </div>
            <h3 className="text-xl font-bold text-white mb-3">Trackable Progress</h3>
            <p className="text-muted-foreground text-sm leading-relaxed">
              Visualize your journey. Mark chapters as complete and watch your progress bar move toward mastery.
            </p>
          </div>
        </div>
      </section>

      {/* Social Proof / Footer Minimal */}
      <footer className="border-t border-white/5 py-12 text-center">
        <p className="text-xs text-muted-foreground uppercase tracking-[0.2em]">
          Designed for Lifelong Learners • 2026 PathForge
        </p>
      </footer>
    </main>
  );
}
</file>

</files>
